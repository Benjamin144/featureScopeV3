<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>...find your relatable interests</title>
</head>
<body>
    <h1>FeatureScopeV3</h1>
    <!-- Header, Input Box, that prompts the user ti input a URL & submit -->
    <h4>Add a new influencer</h4>
    <input class="channel-input" type="text" placeholder="paste Odysee url" /> <!-- Adding a new class to this input-->
    <button type="submit" onclick="submitChannel()">submit</button>            <!-- Adding a new onclick handler thats attached to a new function below -->

    <div class="container"></div>
<!-- Helper functions that allows new documents to be added -->

    <script>

        function submitChannel() { 
            const channelValue = document.querySelector('channel-input)').value
            // extacts that '.value' and sends it to a server
            // server consists of a single route/influencers with the GET and POST methods for REST API provisoning.
            fetch('http://localhost:3000/influencers', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({channelURL})
            })

        }

        function newEl(type, attrs={}) {                        // this takes a type i.e <header>, <div>, <img>, then an object of attributes that will apply
                                                                // all of these attributes to this element.
            const el = document.createElement(type);            // creates a new element with .createElement method.
            for (let attr in attrs) {                           // then this will iterate through those attributes checking them one at a time
                const value = attrs[attr];
                if (attr == 'innerText') el.innerText = value;  // then it will finally apply these attributes with innerText singled out to set the property, instead of running a function.
                else el.setAttribute(attr, value);
            }
            return el;
        }

        // below I replaced list with async function to fetch list of influencers to API 

            async function loadInfluencers() {
                const res = await fetch('http://localhost:3000/influencers'); // within it using native javascript fetch function. Awaits for that to finish and move all rendered code inside too.
                const influencers = await res.json(); //use.json method to extract all of the data

                const ctr = document.querySelector('.container'); // setting a <div> and using a delector query
        
                influencers.forEach(influencer => { // loop through influencers
                    const card = newEl('div', {class: 'card'}); // can select a child element as card
                    const title = newEl('h4', {innerText: influencer.name});
                    const img = newEl('img', {src: influencer.img});
                    card.appendChild(title);
                    card.appendChild(img);
                    ctr.appendChild(card); // and add one card onto the end with the append method. 
                })
            }
            
            loadInfluencers(); // calls the function after being defined
    
        // Professor Dave - mathematician
        // games from scratch / odysee
        // simple electronics/ odysee
        // ebay accounts
        // amazon accounts

        // renders list of content creators as HTML (divs) - formatted as cards from json file
        // sends data by linking form to API with an event listener when clicking submit....

    </script> 
    <!---->
    <style>
        .container {
            display: flex;
        }
        .card{
            margin: 5px;
            padding: 20px;
            border: 1px solid black;
        }

    
    </style>
    
</body>
</html>